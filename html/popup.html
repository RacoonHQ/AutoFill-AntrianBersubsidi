<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Form Otomatis</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>
  <div class="app-container">
    <!-- Header Bar -->
    <div class="header-bar">
      <div class="user-info-header">
        <button class="settings-btn" id="settingsBtn" title="Settings" style="margin-right: 8px;">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
            <circle cx="12" cy="12" r="3"></circle>
          </svg>
        </button>
        <span class="user-id" id="headerUserId">Guest</span>
        <div class="user-expiry" id="userExpiry">
          <!-- Expiration info will be inserted here -->
        </div>
      </div>
      <div class="header-actions">
        <div class="bmkg-clock" id="bmkgClock" title="Waktu BMKG">
          <span id="bmkgTime">--:--:--</span>
          <span id="bmkgDate">--/--/----</span>
        </div>
      </div>
    </div>

    <!-- Navigation Bar -->
    <div class="navbar">
      <button class="nav-btn active" data-page="actions" title="Halaman Aksi Cepat">Aksi Cepat</button>
      <button class="nav-btn" data-page="form" title="Halaman Form Data">Form Data</button>
    </div>

    <!-- Content Area -->
    <div class="content-area login-only">
      <!-- Quick Actions Page -->
      <div id="actionsPage" class="page">
        <div class="actions-content">
          <div class="quick-actions">
            <div class="site-info">
              <div class="site-icon">
                <img src="../icon.png" alt="Icon" width="52" height="52">
              </div>
              <div class="site-name">antrianpanganbersubsidi.pasarjaya.co.id</div>
              <div class="site-status">Siap digunakan</div>
            </div>

            <div class="action-buttons">
              <button type="button" id="openWeb" class="action-btn" title="Buka website antrian pangan bersubsidi">
                Buka Situs
              </button>
              <button type="button" id="runScript" class="action-btn primary" title="Jalankan auto-fill pada website yang sedang dibuka">
                Jalankan Auto-Fill
              </button>
            </div>
          </div>

          <!-- User Info (hidden - removed welcome message and logout) -->
          <div id="userInfo" class="user-info hidden" style="display: none;">
            <p>Selamat datang, <span id="userName"></span>!</p>
            <button type="button" id="logoutButton" class="logout-btn" title="Keluar dari akun">Logout</button>
          </div>

          <!-- Trial Status Section -->
          <div id="trialStatusSection" class="trial-status-section hidden">
            <div class="trial-info">
              <h3>Mode Trial</h3>
              <p id="trialMessage">Sisa waktu trial: <span id="trialDays">3</span> hari</p>
              <p class="trial-note">Setelah trial berakhir, Anda perlu login untuk melanjutkan menggunakan aplikasi.</p>
            </div>
          </div>
        </div>

        <!-- Actions Footer -->
        <div class="actions-footer">
          <p>&copy; 2025 <a href="https://github.com/RacoonHQ" target="_blank">RacoonHQ</a> All rights reserved</p>
        </div>
      </div>

      <!-- Form Data Page -->
      <div id="formPage" class="page">
        <div class="form-container">
          <h3 class="form-title">Data Profil</h3>
          <p class="form-description" style="text-align: justify; font-size: 13px; color: #666; margin-bottom: 20px; line-height: 1.5;">
            <strong>Kebijakan Privasi:</strong> Data yang Anda masukkan hanya disimpan sementara di local storage browser Anda dan tidak pernah dikirim atau disimpan ke server manapun. Kami menghormati privasi Anda dan tidak mengumpulkan data pribadi apapun. Data akan otomatis terhapus ketika Anda menutup browser atau membersihkan cache.
          </p>

          <form id="profileForm">
            <div class="formdata-section">
              <!-- Row 0: Wilayah & Lokasi -->
              <div class="form-row">
                <div class="form-group">
                  <label for="wilayahSelect" class="form-label">Wilayah</label>
                  <select class="form-control" id="wilayahSelect" title="Pilih wilayah untuk mengisi formulir" required>
                    <option value="">Pilih Wilayah</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="lokasiSelect" class="form-label">Lokasi</label>
                  <select class="form-control" id="lokasiSelect" title="Pilih lokasi untuk mengisi formulir" required>
                    <option value="">Pilih Lokasi</option>
                  </select>
                </div>
              </div>

              <!-- Row 1: KK & KTP -->
              <div class="form-row">
                <div class="form-group">
                  <label for="kkInput" class="form-label">No. Kartu Keluarga</label>
                  <input type="text" class="form-control" id="kkInput" maxlength="16" placeholder="Masukan No KK" title="Masukkan nomor Kartu Keluarga (16 digit)" required>
                </div>
                <div class="form-group">
                  <label for="ktpInput" class="form-label">No. KTP</label>
                  <input type="text" class="form-control" id="ktpInput" maxlength="16" placeholder="Masukan No KTP" title="Masukkan nomor KTP (16 digit)" required>
                </div>
              </div>

              <!-- Row 2: Kartu & Tanggal Lahir -->
              <div class="form-row">
                <div class="form-group">
                  <label for="kartuInput" class="form-label">No. Kartu ATM</label>
                  <input type="text" class="form-control" id="kartuInput" maxlength="16" placeholder="Masukan No ATM" title="Masukkan nomor kartu ATM (16 digit)" required>
                </div>
                <div class="form-group">
                  <label for="tanggalLahirInput" class="form-label">Tanggal Lahir</label>
                  <input type="date" class="form-control" id="tanggalLahirInput" title="Pilih tanggal lahir Anda" required>
                </div>
              </div>
            </div>

            <!-- Auto Submit Toggle -->
            <div class="checkbox-group">
              <label for="autoSubmitToggle" title="Otomatis submit formulir setelah diisi">Auto-submit setelah fill</label>
              <input type="checkbox" id="autoSubmitToggle">
            </div>

            <!-- Action Buttons -->
            <div class="btn-group">
              <button type="button" id="saveProfile" class="btn btn-primary" title="Simpan data profil ke local storage">Simpan</button>
              <button type="button" id="resetLocation" class="btn btn-secondary" title="Reset pilihan wilayah dan lokasi">Reset Lokasi</button>
            </div>

            <div class="btn-group">
              <button type="button" id="resetAll" class="btn btn-secondary" title="Reset semua data profil">Reset Semua</button>
            </div>

            <div id="statusText" class="status"></div>
          </form>
        </div>
      </div>

      <!-- Settings Page -->
      <div id="settingsPage" class="page">
        <div class="form-container">
          <div class="settings-header">
            <button type="button" id="backToMain" class="back-btn" title="Kembali ke halaman utama">‚Üê</button>
            <h3 class="form-title">Pengaturan</h3>
          </div>

          <!-- Unified Settings Container -->
          <div class="settings-container">
            <div class="settings-content">
              <!-- User Profile Section -->
              <div class="settings-section">
                <h4 class="settings-title">
                  <svg class="section-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg>
                  Profil Pengguna
                </h4>
                <div class="user-profile-card">
                  <div class="profile-row">
                    <span class="profile-label">User ID:</span>
                    <span class="profile-value" id="settingsUserId">Guest</span>
                  </div>
                  <div class="profile-row">
                    <span class="profile-label">Status:</span>
                    <span class="profile-value" id="settingsUserStatus">Tidak Login</span>
                  </div>
                  <div class="profile-row">
                    <span class="profile-label">Kadaluarsa:</span>
                    <span class="profile-value" id="settingsUserExpiry">-</span>
                  </div>
                  <div class="profile-row">
                    <button type="button" id="settingsLogoutBtn" class="btn-logout" title="Keluar dari akun">Logout</button>
                  </div>
                </div>
              </div>

              <!-- Auto Features Section -->
              <div class="settings-section">
                <h4 class="settings-title">
                  <svg class="section-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"></path>
                  </svg>
                  Fitur Otomatis
                </h4>

                <!-- Auto Fill Toggle -->
                <div class="feature-toggle">
                  <div class="toggle-info">
                    <h5 class="feature-title">
                      <svg class="feature-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                      </svg>
                      Auto-Fill Otomatis
                    </h5>
                    <p class="feature-description">Otomatis mengisi formulir pada website yang dibuka</p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="autoFillToggle" title="Aktifkan fitur auto-fill otomatis" checked>
                    <span class="slider round"></span>
                  </label>
                </div>

                <!-- Auto Open Website -->
                <div class="feature-toggle">
                  <div class="toggle-info">
                    <h5 class="feature-title">
                      <svg class="feature-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                        <path d="M2 12h20"></path>
                      </svg>
                      Auto-Open Website
                    </h5>
                    <p class="feature-description">Otomatis membuka 5 tab website setiap hari pada jam 07.00 WIB</p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="autoOpenWebsiteToggle" title="Aktifkan fitur auto-open website">
                    <span class="slider round"></span>
                  </label>
                </div>

                <!-- Time Settings (shown when auto-open is enabled) -->
                <div id="timeSettings" class="time-settings" style="display: none;">
                  <h5 style="margin: 0 0 16px 0; color: #2c3e50; font-weight: 600;">
                    <svg class="feature-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px; vertical-align: middle;">
                      <circle cx="12" cy="12" r="10"></circle>
                      <polyline points="12,6 12,12 16,14"></polyline>
                    </svg>
                    Pengaturan Waktu
                  </h5>

                  <div class="form-group">
                    <label class="form-label">Waktu Auto-Open</label>
                    <div class="time-display">
                      <span class="time-fixed">Setiap hari pukul 07:00 WIB</span>
                      <p class="time-note">Otomatis menyesuaikan dengan jam perangkat Anda</p>
                    </div>
                  </div>

                  <div class="btn-group">
                    <button type="button" id="testFeatures" class="btn btn-secondary" title="Test fitur-fitur yang aktif">Test Sekarang</button>
                  </div>
                </div>
              </div>

              <!-- About Section -->
              <div class="settings-section">
                <h4 class="settings-title">
                  <svg class="section-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                    <line x1="12" y1="17" x2="12.01" y2="17"></line>
                  </svg>
                  Tentang Extension
                </h4>
                <div class="settings-footer" style="margin: 0; box-shadow: none; border: none; background: #fafbfc; border-radius: 8px;">
                  <div class="footer-content">
                    <div class="footer-info">
                      <p><strong>Versi:</strong> 2.0.1</p>
                      <p><strong>Developer:</strong> RacoonHQ</p>
                      <p><strong>Website:</strong> <a href="https://github.com/RacoonHQ" target="_blank">GitHub</a></p>
                    </div>
                    <p class="footer-description">
                      Extension untuk auto-fill formulir antrian pangan bersubsidi.
                      Data disimpan secara lokal dan aman di browser Anda.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Login Section (shown when not logged in) - MOVED AFTER content-area -->
    <div id="loginSection" class="login-section">
      <h2 class="login-title">Login Sistem</h2>
      <div class="form-group">
        <label for="userId" class="form-label">User ID</label>
        <input type="text" class="form-control" id="userId" placeholder="Masukkan User ID" title="Masukkan username untuk login" required>
      </div>
      <div class="form-group">
        <label for="password" class="form-label">Password</label>
        <input type="password" class="form-control" id="password" placeholder="Masukkan Password" title="Masukkan password untuk login" required>
      </div>
      <button type="button" id="loginButton" class="btn btn-primary" style="width: 100%;" title="Login ke sistem">Login</button>
      <div id="loginStatus" class="status"></div>

      <!-- Login Footer -->
      <div class="login-footer">
        <p id="loginFooterText">Silakan login terlebih dahulu untuk mengakses fitur auto-fill formulir secara otomatis.</p>
      </div>
    </div>
  </div>

  <script src="../js/popup.js"></script>
  <script src="../js/navigation.js"></script>
  <script src="../js/popup-clock.js"></script>
</body>
</html>
